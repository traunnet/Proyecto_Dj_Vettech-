<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <title>Registro</title>

    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- TU CSS -->
    <link rel="stylesheet" type="text/css" href="resources/css/registro.css"/>
</h:head>

<h:body class="bg-gif">

    <!-- NAV BAR -->
    <nav class="navbar navbar-dark navbar-blur px-4">
        <span class="navbar-brand mb-0 h1">Luppy &amp; Sus Mascotas</span>
        <a href="index.xhtml" class="text-white">Volver al inicio</a>
    </nav>

    <!-- CONTENEDOR CENTRAL -->
    <div class="d-flex justify-content-center align-items-center main-container">

        <div class="form-card shadow-lg">

            <h3 class="text-center mb-3 text-white fw-bold">Crear Cuenta</h3>

            <!-- Mensajes globales -->
            <h:messages globalOnly="true" style="color: #ffb3b3;"/>

            <h:form id="registerForm">

                <!-- Tipo Documento -->
                <label class="form-label text-white">Tipo de Documento</label>
                <h:selectOneMenu id="tipoDoc"
                                 value="#{loginBean.nuevoUsuario.tipoDoc}"
                                 styleClass="form-select form-input"
                                 required="true"
                                 requiredMessage="Seleccione el tipo de documento">
                    <f:selectItem itemValue="" itemLabel="Seleccione..."/>
                    <f:selectItem itemValue="CC" itemLabel="C√©dula de Ciudadan√≠a"/>
                    <f:selectItem itemValue="TI" itemLabel="Tarjeta de Identidad"/>
                    <f:selectItem itemValue="CE" itemLabel="C√©dula de Extranjer√≠a"/>
                    <f:selectItem itemValue="PA" itemLabel="Pasaporte"/>
                </h:selectOneMenu>
                <h:message for="tipoDoc" style="color:#ffb3b3"/>

                <!-- Nombre -->
                <label class="form-label text-white mt-3">Nombre</label>
                <h:inputText id="nombre"
                             value="#{loginBean.nuevoUsuario.nombre}"
                             styleClass="form-control form-input"
                             required="true"
                             maxlength="20"
                             requiredMessage="Ingrese el nombre"
                             validatorMessage="El nombre debe iniciar en may√∫scula y contener solo letras">
                    <f:validateRegex pattern="^[A-Z√Å√â√ç√ì√ö√ë][a-z√°√©√≠√≥√∫√±A-Z√Å√â√ç√ì√ö√ë ]{1,19}$"/>
                </h:inputText>
                <h:message for="nombre" style="color:#ffb3b3"/>

                <!-- Apellido -->
                <label class="form-label text-white mt-3">Apellido</label>
                <h:inputText id="apellido"
                             value="#{loginBean.nuevoUsuario.apellido}"
                             styleClass="form-control form-input"
                             required="true"
                             maxlength="20"
                             requiredMessage="Ingrese el apellido"
                             validatorMessage="El apellido debe iniciar en may√∫scula y contener solo letras">
                    <f:validateRegex pattern="^[A-Z√Å√â√ç√ì√ö√ë][a-z√°√©√≠√≥√∫√±A-Z√Å√â√ç√ì√ö√ë ]{1,19}$"/>
                </h:inputText>
                <h:message for="apellido" style="color:#ffb3b3"/>

                <!-- Correo -->
                <label class="form-label text-white mt-3">Correo</label>
                <h:inputText id="correo"
                             value="#{loginBean.nuevoUsuario.correo}"
                             styleClass="form-control form-input"
                             required="true"
                             requiredMessage="Ingrese el correo">
                </h:inputText>
                <h:message for="correo" style="color:#ffb3b3"/>

                <!-- Contrase√±a -->
                <label class="form-label text-white mt-3">Contrase√±a</label>
                <div class="password-container">
                    <h:inputSecret id="contrasena"
                                   value="#{loginBean.nuevoUsuario.contrasena}"
                                   styleClass="form-control form-input"
                                   required="true"
                                   requiredMessage="Ingrese la contrase√±a"/>
                    <span class="toggle-pass" onclick="togglePassword('registerForm:contrasena', this)">üëÅÔ∏è</span>
                </div>
                <h:message for="contrasena" style="color:#ffb3b3"/>

                <!-- Confirmar contrase√±a -->
                <label class="form-label text-white mt-3">Confirmar Contrase√±a</label>
                <div class="password-container">
                    <input type="password" id="confirmPass" class="form-control form-input" required='required'/>
                    <span class="toggle-pass" onclick="togglePassword('confirmPass', this)">üëÅÔ∏è</span>
                </div>
                <small id="passError" class="text-warning"></small>

                <!-- Direcci√≥n -->
                <label class="form-label text-white mt-3">Direcci√≥n</label>
                <h:inputText id="direccion"
                             value="#{loginBean.nuevoUsuario.direccion}"
                             styleClass="form-control form-input"
                             maxlength="40"
                             required="true"
                             requiredMessage="Ingrese la direcci√≥n">
                    <f:validateRegex pattern="^[A-Za-z0-9#\\-\\. ]{3,40}$"/>
                </h:inputText>
                <h:message for="direccion" style="color:#ffb3b3"/>

                <!-- Telefono -->
                <label class="form-label text-white mt-3">Tel√©fono</label>
                <h:inputText id="telefono"
                             value="#{loginBean.nuevoUsuario.telefono}"
                             styleClass="form-control form-input"
                             maxlength="10">
                    <f:validateRegex pattern="^[0-9]{7,10}$"/>
                </h:inputText>
                <h:message for="telefono" style="color:#ffb3b3"/>

                <!-- BOT√ìN -->
                <div class="d-grid mt-4">
                    <h:commandButton value="Registrar"
                                     action="#{loginBean.registrar}"
                                     onclick="return validarPasswords()"
                                     styleClass="btn btn-primary btn-lg"/>
                </div>

                <!-- Links -->
                <div class="text-center mt-3">
                    <a href="login.xhtml" class="text-white">Volver al inicio de sesi√≥n</a>
                </div>

            </h:form>

        </div>
    </div>

    <!-- FOOTER -->
    <footer class="footer-blur text-center text-white py-2">
        Luppy &amp; Sus Mascotas ¬© 2025 ¬∑ Todos los derechos reservados
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JS propio -->
    <script>
        function togglePassword(id, el) {
            let input = document.getElementById(id);
            input.type = input.type === "password" ? "text" : "password";
        }

        function validarPasswords() {
            let p1 = document.getElementById("registerForm:contrasena").value;
            let p2 = document.getElementById("confirmPass").value;
            let error = document.getElementById("passError");

            if (p1 !== p2) {
                error.innerHTML = "Las contrase√±as no coinciden.";
                return false;
            }
            return true;
        }
    </script>

</h:body>
</html>
